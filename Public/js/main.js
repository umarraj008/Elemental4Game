const c=document.getElementById("canvas"),ctx=c.getContext("2d");var CURRENT_LANGUAGE={};let l=sessionStorage.getItem("language");if(null!=l&&null!=l)switch(l){case"0":CURRENT_LANGUAGE=LANGUAGE.english;break;case"1":CURRENT_LANGUAGE=LANGUAGE.spanish;break;case"2":CURRENT_LANGUAGE=LANGUAGE.french;break;case"3":CURRENT_LANGUAGE=LANGUAGE.italian;break;case"4":CURRENT_LANGUAGE=LANGUAGE.chinese;break;case"5":CURRENT_LANGUAGE=LANGUAGE.japanese}else CURRENT_LANGUAGE=LANGUAGE.english;var sceneManager=new SceneManager(-2),volumeSetting=.4;let cursorSetting=sessionStorage.getItem("cursorSetting");sceneManager.cursorHightlight=null!=cursorSetting&&null!=cursorSetting&&"true"==cursorSetting;var colorBlindMode=!1;let colorBlindModeStorage=sessionStorage.getItem("colorBlindMode");console.log(colorBlindModeStorage),colorBlindMode=null!=colorBlindModeStorage&&null!=colorBlindModeStorage&&"true"==colorBlindModeStorage;const loader=new Loader(45,8),airBackground=loader.loadImage("resources/images/AirMapFull.png"),earthBackground=loader.loadImage("resources/images/EarthMapFull.png"),fireBackground=loader.loadImage("resources/images/FireMapFull.png"),waterBackground=loader.loadImage("resources/images/WaterMapFull.png"),wizards=loader.loadImage("resources/images/wizards.png"),platform=loader.loadImage("resources/images/platform1.png");var fireSpriteSheet=loader.loadImage("resources/images/fireSpriteSheet.png"),waterSpriteSheet=loader.loadImage("resources/images/waterSpriteSheet.png"),earthSpriteSheet=loader.loadImage("resources/images/earthSpriteSheet.png"),airSpriteSheet=loader.loadImage("resources/images/airSpriteSheet.png");const fireCharacter=loader.loadImage("resources/images/fireCharacter.png"),waterCharacter=loader.loadImage("resources/images/waterCharacter.png"),earthCharacter=loader.loadImage("resources/images/earthCharacter.png"),airCharacter=loader.loadImage("resources/images/airCharacter.png"),earthMapCloud1=loader.loadImage("resources/images/EarthMap/EarthMap_Cloud1.png"),earthMapCloud2=loader.loadImage("resources/images/EarthMap/EarthMap_Cloud2.png"),earthMapHill1=loader.loadImage("resources/images/EarthMap/EarthMap_Hill1.png"),earthMapHill2=loader.loadImage("resources/images/EarthMap/EarthMap_Hill2.png"),earthMapHill3=loader.loadImage("resources/images/EarthMap/EarthMap_Hill3.png"),fireMapCloudSingle=loader.loadImage("resources/images/FireMap/FireMap_Cloud_Single.png"),fireMapCloud1=loader.loadImage("resources/images/FireMap/FireMap_Cloud1.png"),fireMapCloud2=loader.loadImage("resources/images/FireMap/FireMap_Cloud2.png"),fireMapCloud3=loader.loadImage("resources/images/FireMap/FireMap_Cloud3.png"),fireMapCloud4=loader.loadImage("resources/images/FireMap/FireMap_Cloud4.png"),fireMapVolcanoLava=loader.loadImage("resources/images/FireMap/FireMap_Volcano_Lava.png"),fireMapVolcano=loader.loadImage("resources/images/FireMap/FireMap_Volcano.png"),waterMapCloudSingle=loader.loadImage("resources/images/WaterMap/WaterMap_Cloud_Single.png"),waterMapCloud1=loader.loadImage("resources/images/WaterMap/WaterMap_Cloud1.png"),waterMapCloud2=loader.loadImage("resources/images/WaterMap/WaterMap_Cloud2.png"),waterMapCloud3=loader.loadImage("resources/images/WaterMap/WaterMap_Cloud3.png"),waterMapCloud4=loader.loadImage("resources/images/WaterMap/WaterMap_Cloud4.png"),waterMapMountains=loader.loadImage("resources/images/WaterMap/WaterMap_Mountains.png"),titleImage=loader.loadImage("resources/images/elemental4LTitle.png"),buttonSpriteSheet=loader.loadImage("resources/images/buttonSpriteSheet.png"),rocks=loader.loadImage("resources/images/rocks.png"),panelSpriteSheet=loader.loadImage("resources/images/panelSpriteSheet.png"),waterMapBlur=loader.loadImage("resources/images/WaterMapFullBlur.png"),fireMapBlur=loader.loadImage("resources/images/FireMapFullBlur.png"),earthMapBlur=loader.loadImage("resources/images/EarthMapFullBlur.png"),airMapBlur=loader.loadImage("resources/images/AirMapFullBlur.png"),allCharacters=loader.loadImage("resources/images/AllCharacters.png"),icons=loader.loadImage("resources/images/icons.png"),volumeIcon0=loader.loadImage("resources/images/speakerIcon0.png"),volumeIcon1=loader.loadImage("resources/images/speakerIcon1.png"),volumeIcon2=loader.loadImage("resources/images/speakerIcon2.png"),soundtrack=loader.loadAudio("resources/audio/soundtrack.mp3"),activatePerkSoundEffect=loader.loadAudio("resources/audio/activatePerk.wav"),buttonAcceptSoundEffect=loader.loadAudio("resources/audio/buttonAccept.wav"),buttonBackSoundEffect=loader.loadAudio("resources/audio/buttonBack.wav"),hitSoundEffect=loader.loadAudio("resources/audio/hit.wav"),loseSoundEffect=loader.loadAudio("resources/audio/lose.wav"),winSoundEffect=loader.loadAudio("resources/audio/win.wav"),gameMusic=loader.loadAudio("resources/audio/gameMusic.mp3");var mouseX,mouseY,now,elapsed,dt=0,frameRate=60,frameInterval=1e3/frameRate,then=Date.now(),FONT="pixel",pauseDrawing=!1,showLogin=!1,SETTINGS={frameRate:60,windParticles:!0,debrisParticles:!0,movingBackground:!0,textIndicators:!0,fullscreen:!1,contrast:100,colorBlindness:0,language:0};function setup(){let e=sessionStorage.getItem("frameRate"),a=sessionStorage.getItem("windParticles"),r=sessionStorage.getItem("debrisParticles"),o=sessionStorage.getItem("movingBackground"),l=sessionStorage.getItem("textIndicators"),s=(sessionStorage.getItem("fullscreen"),sessionStorage.getItem("contrast")),t=sessionStorage.getItem("colorBlindness"),n=sessionStorage.getItem("language");null!=e&&null!=e&&(SETTINGS.frameRate=e),null!=a&&null!=a&&(SETTINGS.windParticles=a),null!=r&&null!=r&&(SETTINGS.debrisParticles=r),null!=o&&null!=o&&(SETTINGS.movingBackground=o),null!=l&&null!=l&&(SETTINGS.textIndicators=l),null!=s&&null!=s&&(SETTINGS.contrast=s),null!=t&&null!=t&&(SETTINGS.colorBlindness=t),null!=n&&null!=n&&(SETTINGS.language=n),"true"==SETTINGS.windParticles&&(SETTINGS.windParticles=!0),"true"==SETTINGS.debrisParticles&&(SETTINGS.debrisParticles=!0),"true"==SETTINGS.movingBackground&&(SETTINGS.movingBackground=!0),"true"==SETTINGS.textIndicators&&(SETTINGS.textIndicators=!0),"true"==SETTINGS.fullscreen&&(SETTINGS.fullscreen=!0),"false"==SETTINGS.windParticles&&(SETTINGS.windParticles=!1),"false"==SETTINGS.debrisParticles&&(SETTINGS.debrisParticles=!1),"false"==SETTINGS.movingBackground&&(SETTINGS.movingBackground=!1),"false"==SETTINGS.textIndicators&&(SETTINGS.textIndicators=!1),"false"==SETTINGS.fullscreen&&(SETTINGS.fullscreen=!1),ctx.imageSmoothingEnabled=!1,sceneManager.updateAllText(),resizeWindow(),main()}function main(){frameInterval=1e3/SETTINGS.frameRate,requestAnimationFrame(main),now=Date.now(),dt=elapsed=now-then,elapsed>frameInterval&&!pauseDrawing&&(then=now-elapsed%frameInterval,sceneManager.run())}function resizeWindow(){var e;c.style.left=0,e=(window.innerWidth-c.clientWidth)/2,c.style.left=e+"px"}function loginButtonPressed(){let e=document.getElementById("email").value,a=document.getElementById("password").value;login(e,a)}function playMusic(){soundtrack.currentTime=0,soundtrack.loop=!0,soundtrack.muted=!1,soundtrack.volume=0,soundtrack.play();let e=setInterval(function(){soundtrack.currentTime<=2&&soundtrack.volume<volumeSetting&&(soundtrack.volume+=.01,soundtrack.volume>=volumeSetting&&(soundtrack.volume=volumeSetting,clearInterval(e)))},10)}function stopMusic(){let e=setInterval(function(){if(soundtrack.volume>0){let a=soundtrack.volume;(a-=.01)<=0&&(a=0,soundtrack.pause(),clearInterval(e)),soundtrack.volume=a}},10)}function startBattleMusic(){gameMusic.currentTime=0,gameMusic.loop=!0,gameMusic.muted=!1,gameMusic.volume=0,gameMusic.play();let e=setInterval(function(){gameMusic.currentTime<=2&&gameMusic.volume<volumeSetting&&(gameMusic.volume+=.01,gameMusic.volume>=volumeSetting&&(gameMusic.volume=volumeSetting,clearInterval(e)))},10)}function stopBattleMusic(){let e=setInterval(function(){if(gameMusic.volume>0){let a=gameMusic.volume;(a-=.01)<=0&&(a=0,clearInterval(e)),gameMusic.volume=a}},10)}window.onresize=resizeWindow,window.onmousemove=function(e){e=e||window.event;var a=canvas.getBoundingClientRect(),r=canvas.width/a.width,o=canvas.height/a.height;mouseX=Math.abs((e.clientX-a.left)*r),mouseY=Math.abs((e.clientY-a.top)*o)},window.onclick=function(e){sceneManager.mouseClick()},window.onkeydown=function(e){switch(13==e.keyCode&&(-1==sceneManager.scene?loginButtonPressed():6!=sceneManager.scene&&7!=sceneManager.scene||sendMessageTextChat()),e.keyCode){case 49:CURRENT_LANGUAGE=LANGUAGE.english,loadLanguage();break;case 50:CURRENT_LANGUAGE=LANGUAGE.spanish,loadLanguage();break;case 51:CURRENT_LANGUAGE=LANGUAGE.french,loadLanguage();break;case 52:CURRENT_LANGUAGE=LANGUAGE.italian,loadLanguage();break;case 53:CURRENT_LANGUAGE=LANGUAGE.chinese,loadLanguage();break;case 54:CURRENT_LANGUAGE=LANGUAGE.japanese,loadLanguage()}},document.onvisibilitychange=function(){"hidden"==document.visibilityState?(pauseDrawing=!0,dt=0,elapsed=0,console.log("paused")):pauseDrawing=!1},setup();